!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.navaid=t()}(this,function(){import e from"regexparam";function t(e,t){history[e]||(history[e]=e,t=history[e+="State"],history[e]=function(n){var r=new Event(e.toLowerCase());return r.uri=n,t.apply(this,arguments),dispatchEvent(r)})}return function(e,n){var r,i=[],s={},a=s.format=function(e){return e?(e="/"+e.replace(/^\/|\/$/g,""),r.test(e)&&e.replace(r,"/")):e};return e="/"+(e||"").replace(/^\/|\/$/g,""),r="/"==e?/^\/+/:new RegExp("^\\"+e+"(?=\\/|$)\\/?","i"),s.route=function(t,n){"/"!=t[0]||r.test(t)||(t=e+t),history[(n?"replace":"push")+"State"](t,null,t)},s.on=function(e,t){return(e=function(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var n,r,i,s,a=[],o="",u=e.split("/");for(u[0]||u.shift();i=u.shift();)"*"===(n=i[0])?(a.push("wild"),o+="/(.*)"):":"===n?(r=i.indexOf("?",1),s=i.indexOf(".",1),a.push(i.substring(1,~r?r:~s?s:i.length)),o+=~r&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(o+=(~r?"?":"")+"\\"+i.substring(s))):o+="/"+i;return{keys:a,pattern:new RegExp("^"+o+"/?$","i")}}(e)).fn=t,i.push(e),s},s.run=function(e){var t,r,o=0,u={};if(e=a(e||location.href.replace(location.origin,""))){for(;o<i.length;o++)if(e=e.indexOf("?")>-1?e.replace(location.search,""):e,t=(r=i[o]).pattern.exec(e)){for(o=0;o<r.keys.length;)u[r.keys[o]]=t[++o]||null;return r.fn(u),s}n&&n(e)}return s},s.listen=function(e){function n(e){s.run()}function i(e){var t=e.target.closest("a"),n=t&&t.getAttribute("href");e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button||e.defaultPrevented||n&&!t.target&&t.host===location.host&&("/"!=n[0]||r.test(n))&&(e.preventDefault(),s.route(n))}return t("push"),t("replace"),addEventListener("popstate",n),addEventListener("replacestate",n),addEventListener("pushstate",n),addEventListener("click",i),addEventListener("hashChange",n),s.unlisten=function(){removeEventListener("popstate",n),removeEventListener("replacestate",n),removeEventListener("pushstate",n),removeEventListener("click",i),removeEventListener("hashChange",n)},s.run(e)},s};});